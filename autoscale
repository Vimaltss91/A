import requests

# Credentials
username = "your_username"
password = "your_password"

# File containing the URLs
input_file = "urls.txt"

# Open and process each URL
with open(input_file, "r") as file:
    for url in file:
        url = url.strip()

        # Remove "api/pypi/" and "packages/packages/"
        updated_url = url.replace("api/pypi/", "").replace("packages/packages/", "")

        # Append "?trace" to the updated URL
        trace_url = f"{updated_url}?trace"

        # Make the request with authentication
        response = requests.get(trace_url, auth=(username, password), verify=False)

        # Check for the desired line in the response content
        if response.status_code == 200:
            lines = response.text.splitlines()
            for line in lines:
                if "Creating a resource handle from line" in line:
                    if "cgbu-cnc-comsvc-opensource-release-python-pypi" in line:
                        print("-comsvc-opensource-release")
                    elif "pypi-remote-cache" in line:
                        print("public repo")
        else:
            print(f"Failed to fetch {trace_url}: {response.status_code}")



#!/bin/bash

# Credentials
USER="your_username"
PASS="your_password"

# File containing the URLs
INPUT_FILE="urls.txt"

# Process each URL
while IFS= read -r url; do
    # Remove "api/pypi/" and "packages/packages/"
    updated_url="${url//api\/pypi\//}"
    updated_url="${updated_url//packages\/packages\//}"

    # Append "?trace" to the updated URL
    trace_url="${updated_url}?trace"

    # Make the request with curl
    response=$(curl -s -u "$USER:$PASS" "$trace_url")

    # Check for the desired line in the response
    if echo "$response" | grep -q "Creating a resource handle from line"; then
        if echo "$response" | grep -q "cgbu-cnc-comsvc-opensource-release-python-pypi"; then
            echo "-comsvc-opensource-release"
        elif echo "$response" | grep -q "pypi-remote-cache"; then
            echo "public repo"
        fi
    else
        echo "No matching line found in the response for $trace_url"
    fi
done < "$INPUT_FILE"
